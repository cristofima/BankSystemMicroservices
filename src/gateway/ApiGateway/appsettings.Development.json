{
  "Logging": {
    "LogLevel": {
      "Default": "Debug",
      "Microsoft.AspNetCore": "Information",
      "Yarp": "Debug",
      "Microsoft.AspNetCore.Authentication": "Debug",
      "Microsoft.AspNetCore.Authorization": "Debug"
    }
  },
  "ReverseProxy": {
    "Routes": {
      "security-auth-route": {
        "ClusterId": "security-cluster",
        "Match": {
          "Path": "/api/v1/auth/{**catch-all}"
        },
        "Transforms": [
          {
            "PathPattern": "/api/v1/auth/{**catch-all}"
          },
          {
            "RequestHeadersCopy": true
          },
          {
            "ResponseHeadersCopy": true
          }
        ]
      },
      "account-api-route": {
        "ClusterId": "account-cluster",
        "Match": {
          "Path": "/api/v1/accounts/{**catch-all}"
        },
        "Transforms": [
          {
            "PathPattern": "/api/v1/accounts/{**catch-all}"
          },
          {
            "RequestHeadersCopy": true
          },
          {
            "ResponseHeadersCopy": true
          }
        ]
      }
    },
    "Clusters": {
      "security-cluster": {
        "LoadBalancingPolicy": "RoundRobin",
        "Destinations": {
          "security-api": {
            "Address": "http://localhost:5153/"
          }
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:30",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/health"
          }
        }
      },
      "account-cluster": {
        "LoadBalancingPolicy": "RoundRobin",
        "Destinations": {
          "account-api": {
            "Address": "http://localhost:5069/"
          }
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:30",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/health"
          }
        }
      }
    }
  },
  "Gateway": {
    "Cors": {
      "AllowedOrigins": [
        "https://localhost:3000",
        "https://localhost:4200",
        "http://localhost:3000",
        "http://localhost:4200"
      ]
    },
    "RateLimiting": {
      "Global": {
        "PermitLimit": 5000,
        "Window": "00:01:00"
      },
      "PerUser": {
        "PermitLimit": 500,
        "Window": "00:01:00"
      },
      "Api": {
        "PermitLimit": 1000,
        "Window": "00:01:00"
      }
    },
    "Security": {
      "EnableHttpsRedirection": false,
      "RequireHttps": false,
      "EnableHsts": false
    }
  },
  "HealthChecks": {
    "TimeoutSeconds": 15,
    "Self": {
      "Name": "self",
      "Message": "API Gateway is running in Development mode"
    },
    "Services": [
      {
        "Name": "security-api",
        "Uri": "https://localhost:7066/health",
        "DisplayName": "Security API Health Check (Dev)",
        "TimeoutSeconds": 15,
        "FailureStatus": "Degraded",
        "Tags": ["security", "authentication", "development"]
      },
      {
        "Name": "account-api",
        "Uri": "https://localhost:7119/health",
        "DisplayName": "Account API Health Check (Dev)",
        "TimeoutSeconds": 15,
        "FailureStatus": "Degraded",
        "Tags": ["accounts", "core", "development"]
      }
    ]
  },
  "Authentication": {
    "Jwt": {
      "Key": "dev-secret-key-min-32-chars-for-hs256-algorithm",
      "Issuer": "https://localhost:5001",
      "Audience": "bank-system-api",
      "ValidateIssuer": true,
      "ValidateAudience": true,
      "ValidateLifetime": true,
      "ValidateIssuerSigningKey": true
    },
    "RequireHttpsMetadata": false
  }
}
